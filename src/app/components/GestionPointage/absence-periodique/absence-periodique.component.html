<div class="card maPetiteCard">
    <div class="p-fluid grid formgrid">
        <div class="field col-4 md:col-4">
            <h5>Date Début</h5>
            <p-calendar appendTo="body" [(ngModel)]="date1" [maxDate]="dateJour" dateFormat="dd/mm/yy" id="date1"  required [ngClass]="{'ng-invalid ng-dirty' : submitted && !date1}"></p-calendar>
            <small *ngIf="submitted && !date1" class="p-error">Renseignez la date de début.</small>
        </div>
        <div class="field col-4 md:col-4">
            <h5>Date Fin</h5>
            <p-calendar appendTo="body" [(ngModel)]="date2" [maxDate]="dateJour" dateFormat="dd/mm/yy" id="date2"  required [ngClass]="{'ng-invalid ng-dirty' : submitted && !date2}"></p-calendar>
            <small *ngIf="submitted && !date2" class="p-error">Renseignez la date de fin.</small>
        </div>
        <div class="field col-4 md:col-4">
            <h5>Matricule</h5>
<!--            <p-inputMask  mask="999999a"  (change)="getChange()" [(ngModel)]="matricule"  id="matricule"  required [ngClass]="{'ng-invalid ng-dirty' : submitted && !matricule}"></p-inputMask>-->
            <p-inputMask  mask="999999a"  (change)="getChange()" [(ngModel)]="matricule"  id="matricule"  required [ngClass]="{'ng-invalid ng-dirty' : submitted && !matricule}"></p-inputMask>
            <small *ngIf="submitted && !matricule" class="p-error">Renseignez le matricule .</small>
        </div>
    </div>
    <div class="mid">
        <p-button label="Rechercher" icon="pi pi-search" styleClass="mr-2 mb-2" [disabled]="disabled" (click)="rechercheByMatricule(date1, date2,matricule)"></p-button>
    </div>
</div>

<!--<div class="grid" *ngIf="tourner==true">
    <h5 class="spinner">Veuillez Patienter...</h5>
    <p-progressSpinner class="spinner"></p-progressSpinner>
</div>-->

<!--<div *ngIf="date1!=null && date2!=null && matricule!=null && !result && erreur==true && tourner==false" class="alert alert-danger" >
    Serveur Indisponible
</div>-->
<div class="grid" *ngIf="erreur==false && tourner==false">
    <div class="col-12">
        <div class="card">
            <p-toolbar styleClass="mb-4">
                <ng-template pTemplate="right">
<!--                    <button pButton pRipple label="Export excel" icon="pi pi-upload" class="mr-2 inline-block"></button>-->
                    <b class="left"><u>Total Absence</u>: {{result.length}} Jour(s)</b>
                </ng-template>
                <ng-template pTemplate="left">
                    <button pButton pRipple label="Export excel" icon="pi pi-upload" class="mr-2 inline-block" (click)="exportAsXLSX(result)"></button>
                    <button pButton pRipple label="Export PDF" icon="pi pi-upload" class="p-button-success mr-2"  (click)="exportTableToPDF()"></button>
                </ng-template>
            </p-toolbar>
            <!-- <div *ngIf="result.length==0">
                Aucune Absence durant la période du {{date1 | date: 'dd/MM/yyyy' }}
                au {{date2 | date: 'dd/MM/yyyy' }}
            </div>
            <div *ngIf="result.length!=0" class="row">
                <div *ngFor="let resul of result" class="col-2">
                    <p-card class="date1">
                        <p class="date">{{resul | date: 'dd/MM/yyyy'}}</p>
                    </p-card>
                </div>
             </div>    -->

             <div *ngIf="result.length==0">
                Aucune Absence durant la période du {{date1 | date: 'dd/MM/yyyy' }}
                au {{date2 | date: 'dd/MM/yyyy' }}
            </div>
            <div *ngIf="result.length!=0">
                <p-table [value]="result" responsiveLayout="scroll" [rows]="10" [globalFilterFields]="['datepointage']" [rows]="10" [paginator]="true" [rowsPerPageOptions]="[10,20,30]" [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [(selection)]="selectedPointages" selectionMode="multiple" [rowHover]="true" dataKey="idpointage">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Dates d'absence</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-resul>
                        <tr>
                            <td>{{ resul | date: 'dd/MM/yyyy' }}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>

   <!--         <p-table #dt [value]="result"  responsiveLayout="scroll" [rows]="10"  [paginator]="true" [rowsPerPageOptions]="[10,20,30]"
                     [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [(selection)]="selectedPointages"
                     selectionMode="multiple" [rowHover]="true" dataKey="idpointage">
                <ng-template pTemplate="caption">
                    <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center">
                        <h5 class="m-0">Absences Périodiques</h5>
                        <span class="block mt-2 md:mt-0 p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Recherche..." >
                        </span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>

                        <th pSortableColumn="datepointage">Dates Absentées  <p-sortIcon field="datepointage"></p-sortIcon></th>

                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-resultat>
                    <tr>
                        <td>{{resultat}}</td>

                    </tr>

                </ng-template>
            </p-table>-->
        </div>
    </div>
</div>
